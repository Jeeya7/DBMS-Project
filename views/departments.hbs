<h1>Departments</h1>

<p>This page will allow viewing, adding, editing, and deleting departments.</p>

<table class="table">
  <thead>
    <tr>
      <th>Department ID</th>
      <th>Department Name</th>
      <th>Actions</th>
    </tr>
  </thead>
  <tbody>

    {{#if departments.length}}
    {{#each departments}}
    <tr>
      <td>{{this.departmentId}}</td>
      <td>{{this.departmentName}}</td>
      <td>
        <form action="/delete-department" method="POST" style="display:inline;">
          <input type="hidden" name="departmentId" value="{{this.departmentId}}">
          <button type="submit">Delete</button>
        </form>
      </td>
    </tr>
    {{/each}}
    {{else}}
    <tr>
      <td colspan="3">No department data yet.</td>
    </tr>
    {{/if}}
  </tbody>
</table>


<h3>Add New Department</h3>
<form action="/add-department" method="POST" class="add-form">

  <label for="departmentName">Department Name:</label>
  <input type="text" id="departmentName" name="departmentName" placeholder="Enter department name" required>

  <button type="submit">Add Department</button>
</form>

<h3>Update Department Details</h3>

<form action="/update-department" method="POST" class="update-form">
  <!-- Select Department by ID -->
  <label for="departmentId">Select Department ID:</label>
  <select id="departmentId" name="departmentId" required>
    <option value="">-- Select an Department ID --</option>
    {{#each departments}}
    <option value="{{this.departmentId}}" data-name="{{this.departmentName}}">
      {{this.departmentId}} â€” {{this.departmentName}}
    </option>
    {{/each}}
  </select>

  <label for="departmentName"> Update Department Name</label>
  <input type="text" id="departmentName" name="departmentName" placeholder="Enter updated department name" required>

  <button type="submit">Update Department</button>
</form>


<script>
  // Only applies to update form
  document.getElementById('updateDepartmentId').addEventListener('change', function () {
    const selected = this.options[this.selectedIndex];
    const name = selected.getAttribute('data-name');
    document.getElementById('updateDepartmentName').value = name || '';
  });
</script>
